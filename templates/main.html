{% load static %}
<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="{% static "/styles/base.css" %}" type="text/css">
    <link rel="stylesheet" href="{% static "/styles/main.css" %}" type="text/css">
    <link rel="stylesheet" href="{% static "/styles/nav.css" %}" type="text/css">
    <title>MemoryProject</title>
</head>
    <body>
    <main>
        <div class="hero">
            {% include 'nav.html' %}
                <h1>–° –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ–º, {{ request.user.first_name }}</h1>
        </div>
        <div class="blocks">
            {% if not test %}
                <div class="exercise-block">
                    <h3 style="margin-bottom: 90px">–£–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ –Ω–∞ —Å–µ–≥–æ–¥–Ω—è</h3>
                    <h2 style="margin-bottom: 42px">–°–µ–≥–æ–¥–Ω—è –ø—Ä–µ–¥—Å—Ç–æ–∏—Ç<br>
                        –ø—Ä–æ–π—Ç–∏ 20 –∑–∞–¥–∞–Ω–∏–π</h2>
                    <div class="progress-bar">
                        <progress id="completion" max="100" value="0">0</progress>
                    </div>
                    <div class="progress">
                        <h4>–ü—Ä–æ–π–¥–µ–Ω–æ 0%</h4>
                        <h4>0/20<br>
                            –Ω–∞–±—Ä–∞–Ω–æ</h4>
                    </div>
                    <div class="buttons">
                        <form method="post">
                            {% csrf_token %}

                            <div class="tooltip">
                                <button type="submit" name='button' value="start" disabled class="is-invalid" id="btn-start">–ö –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—é</button>
                                <span class="tooltip-text" id="tooltip-text">–ü–µ—Ä–µ–¥ –Ω–∞—á–∞–ª–æ–º —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —Ä–∞—Å–ø–µ—á–∞—Ç–∞—Ç—å
                                    –±–ª–∞–Ω–∫, –≤–æ—Å–ø–æ–ª—å–∑–æ–≤–∞–≤—à–∏—Å—å –∫–Ω–æ–ø–∫–æ–π –Ω–∏–∂–µ! üëá</span>
                            </div>
                            <a onclick="OpenButton()" id="download" download href="{% static test_url %}">
                                <button name="button" value="download" type="button" class="btn-download is-valid">–†–∞—Å–ø–µ—á–∞—Ç–∞—Ç—å –±–ª–∞–Ω–∫</button>
                            </a>
                        </form>
                    </div>
                </div>
            {% else %}
                <div class="exercise-block">
                    <h3 style="margin-bottom: 90px">–£–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ –Ω–∞ —Å–µ–≥–æ–¥–Ω—è</h3>
                    <h2 style="margin-bottom: 42px">–ó–∞–¥–∞–Ω–∏–µ –Ω–∞ —Å–µ–≥–æ–¥–Ω—è –≤—ã–ø–æ–ª–Ω–µ–Ω–æ,<br>
                    –∑–∞–≤—Ç—Ä–∞ –ø–æ—è–≤–∏—Ç—Å—è –Ω–æ–≤—ã–π —Ç–µ—Å—Ç</h2>
                    <div class="progress-bar">
                        <progress id="completion" max="100" value="{{ result }}"></progress>
                    </div>
                    <div class="progress">
                        <h4>–ü—Ä–æ–π–¥–µ–Ω–æ {{ result }}%</h4>
                        <h4>{{ value }}/20<br>
                            –Ω–∞–±—Ä–∞–Ω–æ</h4>
                    </div>
                    <a><button disabled id="timer-button">–ö –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—é</button></a>
                </div>
            {% endif %}
            <div class="streak-block">
                <div class="streak-container">
                    <h3>–ü—Ä–æ–¥–æ–ª–∂–∞–π—Ç–µ –≤<br>
                        —Ç–æ–º –∂–µ –¥—É—Ö–µ!</h3>
                    <div>
                        <strong>{{ stats.streak }}</strong>
                        <h4>–î–Ω–µ–π –±–µ–∑ –ø–µ—Ä–µ—Ä—ã–≤–∞<br>
                        –†–µ–∫–æ—Ä–¥ ‚Äî {{ stats.best_streak }}</h4>
                    </div>
                </div>
            </div>
            <div class="rec-block">
                <h3 style="margin-bottom: 125px">–ù–∞—à–∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏</h3>
                <h3 style="margin-bottom: 14px">–ö–∞–∫ –∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è?</h3>
                <p style="margin-bottom: 38px">–ú—ã —Å–æ–±–∏—Ä–∞–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É, —á—Ç–æ–±—ã –≤—ã –æ—Ç—Å–ª–µ–∂–∏–≤–∞–ª–∏<br>
                    —Ä–µ–∑—É–ª—å—Ç–∞—Ç</p>
                <button>–ß–∏—Ç–∞—Ç—å –ø–æ–¥—Ä–æ–±–Ω–µ–µ</button>
            </div>
            <div class="stats-block">
                <h3>–í–∞—à–∞ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å</h3>
                <h4>–ü–æ—Å–ª–µ–¥–Ω–∏–µ 10 –¥–Ω–µ–π:</h4>
                <div class="days">
                {% for day in days %}
                    {% if day.1 == 0 %}
                        <div class="day">
                            <div class="rectangle"></div>
                            <p>{{ day.0 }}</p>
                        </div>
                    {% else %}
                        <div class="day complete">
                            <div class="rectangle"></div>
                            <p>{{ day.0 }}</p>
                        </div>
                    {% endif %}
                {% endfor %}
                </div>
                <div class="stats">
                    <h4>{{ stats.completed }} —Ä–µ—à–µ–Ω–æ –∑–∞ –≤—Å—ë –≤—Ä–µ–º—è</h4>
                </div>
            </div>
        </div>
    </main>
    <script>
        const timerBtn = document.getElementById('timer-button');
        const startButton = document.getElementById('btn-start');
        const tooltipText = document.getElementById('tooltip-text')
        ChangeTimerBtn(timerBtn);


        function ChangeTimerBtn(timerBtn){
            const currentTime = new Date();
            let hours = 23 - currentTime.getUTCHours() - 3;
            let minutes = 59 - currentTime.getUTCMinutes();
            let seconds = 59 - currentTime.getUTCSeconds();

            if (minutes<10){
                minutes = '0' + minutes;
            }
            if (seconds<10){
                seconds = '0' + seconds;
            }
            timerBtn.innerText = hours + ':' + minutes + ':' + seconds;
        }

        setInterval(ChangeTimerBtn, 1000, timerBtn);



        function OpenButton(){
            startButton.removeAttribute('disabled');
            startButton.setAttribute('class', 'btn-start is-valid');
            tooltipText.className = '';
            tooltipText.hidden = true;
        }

    </script>
    </body>
</html>